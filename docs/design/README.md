# 📐 设计文档目录

> 所有新功能的详细设计文档存放在此目录
> **重要**：所有新功能必须先有设计文档，审核通过后才能实施

---

## 📋 目录结构

```
docs/design/
├── README.md              # 本文件：设计文档使用指南
├── .template.md           # 设计文档模板（必读）
├── function-calling-framework.md  # Function Calling 框架设计
└── [feature-name].md      # 其他功能设计文档
```

---

## 🔄 强制流程

### ⚠️ 所有新功能必须遵循此流程

```
1. 需求提出
   ↓
2. 创建设计文档（使用 .template.md）
   ↓
3. 提交审核
   ↓
4. 审核通过 ✅
   ↓
5. 按照设计文档实施
   ↓
6. 代码 + 文档同步提交
```

**❌ 禁止**：未经审核直接编码

---

## 📝 如何创建设计文档

### 步骤1：复制模板

```bash
# 复制模板
cp docs/design/.template.md docs/design/[your-feature-name].md
```

### 步骤2：填写设计文档

**必需章节**（按顺序填写）：
1. ✅ 需求分析 - 清晰描述功能
2. ✅ 技术方案 - 说明如何实现
3. ✅ 代码结构 - 规划文件和代码组织
4. ✅ 实施步骤 - 分步骤说明实施计划
5. ✅ 测试方案 - 说明如何测试
6. ✅ 风险评估 - 识别潜在风险
7. ✅ 替代方案 - 说明为什么选择当前方案

**可选章节**：
- 📊 架构图（使用 Mermaid）
- 📐 数据模型（TypeScript 接口）
- 🔌 接口设计（API 端点）

### 步骤3：提交审核

将设计文档提交给项目维护者审核，审核要点：
- [ ] 符合项目定位（轻量级、无重型依赖）
- [ ] 技术方案合理（最优方案）
- [ ] 实施步骤清晰（可执行）
- [ ] 风险评估充分（识别关键风险）
- [ ] 测试方案完整（覆盖主要场景）

### 步骤4：等待审核通过

**审核结果**：
- 🟢 **通过** - 可以开始实施
- 🔶 **需修改** - 根据意见修改后重新提交
- 🔴 **拒绝** - 方案不合适，需要重新设计

### 步骤5：实施

审核通过后，**严格按照设计文档**实施：
- 遵循实施步骤
- 如需变更设计，必须重新审核

---

## 📚 设计文档示例

### 已完成的设计文档

- **Function Calling 框架** (`function-calling-framework.md`)
  - 状态：✅ 已完成
  - 复杂度：高
  - 参考价值：完整的技术方案设计

### 设计文档最佳实践

1. **清晰的需求描述**
   - 用 1-2 段话说明功能
   - 明确功能范围（包含/不包含）

2. **完整的技术方案**
   - 说明为什么选择这个方案
   - 列出替代方案并说明未选择原因

3. **可执行的实施步骤**
   - 每个步骤都有明确的验收标准
   - 预估每个步骤的时间

4. **充分的测试计划**
   - 单元测试、集成测试、手动测试
   - 覆盖主要使用场景

5. **风险识别**
   - 技术风险
   - 业务风险
   - 每个风险都有应对措施

---

## 🎯 设计文档审核标准

### ✅ 必须满足

1. **符合项目定位**
   - 轻量级架构（不引入重型框架）
   - 无数据库（使用 localStorage）
   - 最小依赖（避免不必要的 npm 包）

2. **技术方案合理**
   - 选择最优方案
   - 说明技术选型理由
   - 考虑维护成本

3. **实施步骤清晰**
   - 步骤可执行
   - 有明确验收标准
   - 时间估算合理

4. **风险评估充分**
   - 识别关键风险
   - 有应对措施
   - 风险可控

5. **测试方案完整**
   - 覆盖主要场景
   - 包含回归测试
   - 可验证功能正确性

### ❌ 常见问题

1. **需求不清晰**
   - 功能描述模糊
   - 边界不明确

2. **技术方案不合理**
   - 引入重型框架
   - 与现有架构冲突
   - 未说明选择理由

3. **实施步骤不可执行**
   - 步骤过于粗略
   - 缺少验收标准
   - 时间估算不准确

4. **测试方案不完整**
   - 只考虑正常场景
   - 缺少边界测试
   - 未考虑回归测试

---

## 📌 注意事项

### 设计文档 ≠ 实施

- 设计文档是**规划**，不是实施
- 设计文档通过审核后，才开始编码
- 实施时严格按照设计文档

### 设计变更管理

- 实施过程中如需变更设计
- 必须更新设计文档
- 重新提交审核

### 设计文档状态管理

每个设计文档应该明确标注状态：
- 🔴 **待审核** - 刚创建，等待审核
- 🟢 **审核通过** - 可以实施
- 🔵 **实施中** - 正在编码
- ✅ **已完成** - 功能已实现

---

## 🔗 相关文档

- [CLAUDE.md](../../CLAUDE.md) - AI 助手工作指南
- [ARCHITECTURE.md](../ARCHITECTURE.md) - 项目架构决策
- [CONTRIBUTING.md](../CONTRIBUTING.md) - 开发规范
- [PROGRESS.md](../PROGRESS.md) - 开发进度
- [DOCUMENTATION_MAINTENANCE.md](../DOCUMENTATION_MAINTENANCE.md) - 文档维护指南

---

**最后更新**：2026-01-17
