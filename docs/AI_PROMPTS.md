# AI开发提示词指南

> 如何有效引导AI编码助手使用项目文档

---

## 🎯 核心原则

**让AI先"学习"再"动手"**

```
错误方式 ❌
"添加用户认证功能"
→ AI可能建议JWT、OAuth、数据库等复杂方案

正确方式 ✅
"这是一个轻量级AI聊天机器人项目。
开发前请阅读 docs/ARCHITECTURE.md 了解项目定位。
然后评估用户认证功能是否符合当前架构。"
```

---

## 📋 标准项目上下文提示词

### 适用于所有AI任务的通用提示词

```
## 项目上下文

你正在为一个AI聊天机器人项目提供开发帮助。

### 项目定位
这是一个轻量级AI聊天机器人（非企业级应用）
- 单体应用（非微服务）
- 无数据库（使用localStorage）
- 最小依赖（6个npm包）
- 快速启动（npm install → npm start）

### 必读文档（按优先级）
1. docs/ARCHITECTURE.md - 技术架构和设计决策
2. docs/CONTRIBUTING.md - 开发规范和常见任务指南
3. docs/SETUP.md - 搭建指南

### 重要约束
- ❌ 不要建议引入重型框架（Vue、React、NestJS）
- ❌ 不要建议添加数据库（MongoDB、PostgreSQL）
- ❌ 不要重写SSE为WebSocket
- ⚠️ public/config.js 是自动生成的，不要手动编辑

### 技术栈
- 后端：Express.js
- 前端：原生JavaScript（单文件应用）
- 流式响应：SSE (Server-Sent Events)
- 对话存储：localStorage

### 开发前检查清单
在提供建议前，请确认：
1. 已阅读 docs/ARCHITECTURE.md 了解技术选型理由
2. 已阅读 docs/CONTRIBUTING.md 了解编码规范
3. 建议符合项目定位（轻量级、简单、可维护）
4. 没有违反重要约束

开始任何开发任务前，请先说明你理解了项目定位。
```

---

## 🔧 场景化提示词模板

### 场景1：添加新功能

```
## 任务：添加 [功能名称]

### 项目上下文
[粘贴上面的"标准项目上下文提示词"]

### 具体需求
[描述你的功能需求]

### 请按以下步骤进行
1. 先阅读 docs/ARCHITECTURE.md 确认功能符合项目定位
2. 检查是否已有类似实现（搜索代码）
3. 评估实现复杂度是否符合轻量级定位
4. 基于 docs/CONTRIBUTING.md 的"常见任务指南"提供实现方案
5. 说明为什么这个方案适合当前项目

### 示例
如果需求是"添加用户认证"，请先说明：
- 这是否超出项目当前定位（轻量级）
- 是否需要架构调整
- 是否应该创建独立分支/项目
```

### 场景2：修复Bug

```
## 任务：修复 [Bug描述]

### 项目上下文
[粘贴上面的"标准项目上下文提示词"]

### Bug详情
- 问题描述：[具体描述]
- 错误信息：[错误日志]
- 复现步骤：[如何触发]

### 调试指南
1. 查看 docs/CONTRIBUTING.md 的"调试SSE流式响应"部分
2. 检查后端日志（npm start的输出）
3. 检查前端浏览器控制台
4. 参考现有类似功能的实现

### 请提供
1. 根本原因分析
2. 修复方案（保持代码风格一致）
3. 如何避免类似问题
```

### 场景3：代码审查

```
## 任务：审查 [文件/功能]

### 项目上下文
[粘贴上面的"标准项目上下文提示词"]

### 审查重点
1. 是否违反 docs/CONTRIBUTING.md 的编码规范
2. 是否符合 docs/ARCHITECTURE.md 的架构设计
3. 是否有重复造轮子
4. 是否过度设计

### 审查维度
- ✅ 代码风格一致性
- ✅ 错误处理完整性
- ✅ 性能影响评估
- ✅ 安全性考虑
- ✅ 可维护性

请基于项目文档提供具体改进建议。
```

### 场景4：重构代码

```
## 任务：重构 [文件/功能]

### 项目上下文
[粘贴上面的"标准项目上下文提示词"]

### 重构目标
[说明重构的原因和目标]

### 重构原则
1. 参考 docs/ARCHITECTURE.md 的技术栈选择理由
2. 遵循 docs/CONTRIBUTING.md 的编码规范
3. 保持轻量级定位（不要引入重型框架）
4. 保持向后兼容

### 重构步骤
1. 分析现有实现
2. 识别问题
3. 提出符合项目定位的方案
4. 说明为什么这个方案更好
5. 渐进式重构（先小范围测试）

### 示例
如果要求"迁移到TypeScript"，请先说明：
- 这是否与"快速迭代"定位冲突
- 构建步骤增加的权衡
- 是否应该在独立分支尝试
```

### 场景5：性能优化

```
## 任务：优化 [性能问题]

### 项目上下文
[粘贴上面的"标准项目上下文提示词"]

### 性能问题
[描述具体的性能问题]

### 优化原则
1. 优先代码层面优化（而非架构重构）
2. 避免过度优化
3. 符合轻量级定位
4. 考虑成本效益

### 请提供
1. 性能瓶颈分析
2. 优化方案（代码层面）
3. 性能提升预估
4. 潜在风险评估

### 注意
- 不要建议"添加Redis缓存"等重型方案
- 不要建议"迁移到微服务"
- 优先考虑算法和数据结构优化
```

---

## 💬 常见对话示例

### 示例1：用户要求添加数据库

```
❌ 错误的AI回复：
"建议使用MongoDB存储对话历史，这样可以在多个设备间同步..."

✅ 正确的AI回复：
"我已阅读 docs/ARCHITECTURE.md，了解到项目有意选择localStorage而不是数据库：

选择理由：
- 零成本、零运维
- 隐私保护（数据不离开用户设备）
- 简化部署
- 符合轻量级定位

如果需要跨设备同步或用户认证，这已经超出项目当前定位范围。
建议：
1. 如果只是个人使用，localStorage已经足够
2. 如果需要跨设备同步，应该创建新的企业级项目
3. 如果一定要实现，请在独立分支尝试并重构架构"
```

### 示例2：用户要求迁移到Vue

```
❌ 错误的AI回复：
"建议使用Vue 3重构前端，使用Vite作为构建工具..."

✅ 正确的AI回复：
"我已阅读 docs/ARCHITECTURE.md，了解到项目有意使用原生JavaScript：

选择理由：
- 零依赖，无需构建工具
- 快速迭代，修改即生效
- 学习价值，理解底层原理
- 轻量级，单文件可运行

Vue会增加：
- 构建步骤（Vite/Webpack）
- 学习曲线
- 项目复杂度
- 与'快速启动'定位冲突

建议：
1. 如果只是添加简单功能，原生JS完全够用
2. 如果需要复杂组件系统，说明项目定位需要重新考虑
3. 如果一定要迁移，应该创建新项目并说明架构变更原因"
```

### 示例3：用户要求添加新AI模型

```
✅ 正确的AI回复：
"我已阅读 docs/ARCHITECTURE.md 和 docs/CONTRIBUTING.md。

添加新AI模型符合项目定位（保持轻量级）。以下是实现步骤：

1. 在 .env 添加 API_KEY
2. 在 config.js 添加配置对象
3. 在 server.js 的 AIAdapter 类添加方法
4. 在 validators.js 添加验证

参考 docs/CONTRIBUTING.md 的'任务1：添加新的AI模型'章节。

需要我提供具体的代码实现吗？"
```

---

## 🎓 提示词最佳实践

### DO ✅

1. **始终包含项目上下文**
   - 第一次对话时粘贴完整上下文
   - 后续对话可以简化（AI会记住）

2. **引用具体文档**
   - "参考 docs/ARCHITECTURE.md 的第X章节"
   - "按照 docs/CONTRIBUTING.md 的代码模板"

3. **要求AI先学习**
   - "请先阅读 X 文档再提供建议"
   - "说明你理解了项目的什么定位"

4. **明确约束**
   - "不要建议重型框架"
   - "保持轻量级定位"
   - "符合现有代码风格"

### DON'T ❌

1. **不要省略项目上下文**
   - ❌ "帮我写一个聊天功能"
   - ✅ "这是一个轻量级AI聊天机器人项目（详见docs/ARCHITECTURE.md）。帮我写一个聊天功能..."

2. **不要让AI猜测**
   - ❌ "如何实现这个功能？"
   - ✅ "按照 docs/CONTRIBUTING.md 的规范，如何实现这个功能？"

3. **不要忽略文档**
   - ❌ "直接给我代码"
   - ✅ "先阅读 docs/CONTRIBUTING.md 的相关章节，再给我代码"

---

## 🔄 持续对话技巧

### 第一次对话（完整上下文）

```
[粘贴"标准项目上下文提示词"]

现在帮我 [描述任务]
```

### 后续对话（简化上下文）

```
继续这个任务。
记得：
- 这是轻量级项目
- 不要建议重型框架
- 参考 docs/CONTRIBUTING.md 的代码规范
```

### 当AI偏离时

```
⚠️ 你的建议不符合项目定位。

请重新阅读：
- docs/ARCHITECTURE.md - 项目定位和技术选型理由
- docs/CONTRIBUTING.md - 重要约束

然后提供符合轻量级定位的方案。
```

---

## 📝 提示词清单

### 开发前必读清单

- [ ] 包含"标准项目上下文提示词"
- [ ] 引用相关文档
- [ ] 说明具体需求
- [ ] 要求AI确认理解项目定位

### AI回复验证清单

- [ ] AI的建议符合项目定位吗？
- [ ] AI的建议违反重要约束吗？
- [ ] AI引用了相关文档吗？
- [ ] 有更好的轻量级方案吗？

---

## 🚀 快速参考

### 最短有效提示词

```
这是一个轻量级AI聊天机器人项目（非企业级）。
开发前请阅读：docs/ARCHITECTURE.md 和 docs/CONTRIBUTING.md
重要约束：不要建议重型框架（Vue/React/NestJS）和数据库。

[你的需求]
```

### 最详细提示词

```
[粘贴"标准项目上下文提示词"]

## 当前任务
[详细描述任务，包括背景、需求、约束]

## 期望输出
1. 先说明你理解的项目定位
2. 分析需求的合理性
3. 提供符合项目定位的实现方案
4. 说明为什么这个方案适合
5. 引用相关文档章节

请按照上述步骤进行。
```

---

## 🚨 常见陷阱和错误模式

### 陷阱1：文档结构重复

**问题示例**：
```
建议创建新目录：
docs/guides/          # 开发指南
├── tool-development.md
└── api-integration.md

但实际上已有：
docs/CONTRIBUTING.md  # 开发指南（功能重叠）
```

**错误原因**：
- 没有充分检查现有文档结构
- 直接提出新方案而不是先审查现有方案

**正确做法**：
```
1. 先搜索/阅读现有文档
2. 检查是否有功能重叠
3. 优先扩展现有文档，而非创建新文件
4. 符合"轻量级"定位：文档也应该轻量
```

**检查清单**：
- [ ] 建议新文档前，是否检查了 `docs/` 目录？
- [ ] 是否阅读了 `CONTRIBUTING.md` 和 `ARCHITECTURE.md`？
- [ ] 新文档的功能是否可以被现有文档覆盖？
- [ ] 创建新文档是否符合项目的"轻量级"定位？

**经验原则**：
```
✅ 在现有文档中添加章节
✅ 扩展现有文档的结构
❌ 随意创建新的文档文件
❌ 创建功能重叠的目录结构
```

### 陷阱2：过度设计文档结构

**问题示例**：
```
❌ 建议：
docs/
├── guides/              # 开发指南
├── development/         # 详细指南
├── design/              # 设计文档
├── api/                 # API文档
└── tutorials/           # 教程

问题：文档层级过多，信息分散，难以查找
```

**正确做法**：
```
✅ 轻量级项目的文档结构：
docs/
├── ARCHITECTURE.md      # 架构（核心）
├── CONTRIBUTING.md      # 开发指南（唯一入口）⭐
├── PROGRESS.md          # 进度跟踪
├── ROADMAP.md           # 路线图
└── design/              # 仅架构级设计文档
    └── xxx-framework.md # 重大架构变更才有独立文档
```

**判断标准**：
- 这个信息能放进现有文档吗？ → 能，就别创建新文件
- 这是架构级变更吗？ → 不是，就别进 design/ 目录
- 项目定位是轻量级吗？ → 是，文档也应该轻量

### 陷阱3：文档内容重复

**问题示例**：
```
❌ 在两个文档中包含相同的详细内容：

docs/PROGRESS.md (实施计划章节)
├── 第1步：基础框架
│   ├── 任务：5个详细checklist
│   ├── 验收：3条标准
│   └── 预计时间：1-2天
├── 第2步：文本处理工具
│   ├── 任务：3个详细checklist
│   └── 验收：3条标准
└── ...

docs/design/function-calling-framework.md (实施步骤章节)
├── 5.1 第一阶段：基础框架
│   ├── 步骤1.1-1.8：8个详细步骤（包含文件路径）
│   ├── 验收标准：4条详细标准
│   └── 预计时间：精确到0.5小时
├── 5.2 第二阶段：智能引导
│   └── ...
└── ...

问题：80%内容重复，维护成本高，职责不清
```

**错误原因**：
- 没有明确定位每个文档的职责
- 认为两处都需要"实施步骤"
- 没有考虑"概览"vs"详细"的区别

**正确做法**：
```
✅ 明确职责，避免重复：

docs/PROGRESS.md (进度跟踪)
├── 优先级矩阵：功能优先级、价值评估
├── 里程碑：各阶段交付物
└── 阶段概览：一行说明每个步骤
    - 第1步：基础框架（1-2天）- ToolRegistry + ToolExecutor
    - 第2步：文本处理工具（1天）- 文章总结等
    └── 引用：详细实施步骤见 design文档

docs/design/function-calling-framework.md (详细设计)
└── 5. 实施步骤分解
    ├── 5.1 第一阶段：基础框架
    │   ├── 步骤1.1-1.8：详细任务、文件路径、时间估算
    │   └── 验收标准：详细测试要求
    └── ...
```

**文档职责定位原则**：
```
文档类型          职责                  详细程度    更新频率
─────────────────────────────────────────────────────────
ARCHITECTURE.md    架构概览              ⭐⭐       低
                  技术选型理由
                  设计决策

design/*.md       详细技术设计          ⭐⭐⭐⭐⭐   中
                  实施步骤分解
                  代码结构规划
                  测试计划

CONTRIBUTING.md    开发指南             ⭐⭐⭐      低
                  编码规范
                  开发流程

PROGRESS.md       进度跟踪              ⭐⭐       高
                  优先级矩阵
                  里程碑
                  阶段概览（一行）
```

**检查清单**：
- [ ] 每个文档的职责是否明确定义？
- [ ] 是否存在相同详细程度的内容出现在多个文档？
- [ ] 如果需要引用，是否使用了引用标记（> 📋）？
- [ ] "概览"和"详细"是否分别放置？
- [ ] 修改时是否需要同步更新多个地方？

**判断标准**：
- 这个内容是"概览"还是"详细"？
  - 概览 → PROGRESS.md（一行说明）
  - 详细 → design/*.md（完整步骤）
- 这个信息是"进度"还是"设计"？
  - 进度 → PROGRESS.md（优先级、里程碑）
  - 设计 → design/*.md（技术方案、实施步骤）
- 修改一个地方是否能解决问题？
  - 否 → 可能存在重复

**经验原则**：
```
✅ 概览在一处，详细在另一处
✅ 使用引用标记连接相关文档
✅ 每个信息只有一个权威来源
❌ 相同详细程度的内容出现在多处
❌ 需要同时更新多个文档
```

**实际案例**：
```
错误：
❌ PROGRESS.md: 包含详细的实施checklist
❌ design文档: 也包含相同的实施步骤
→ 问题：80%重复，维护负担

正确：
✅ PROGRESS.md: 只有概览（第1步：基础框架 1-2天）+ 引用
✅ design文档: 完整的详细步骤（步骤1.1-1.8，含文件、时间）
→ 优势：职责清晰，无重复
```

---

## 💡 技巧总结

### 核心技巧

1. **上下文前置** - 让AI先理解项目再工作
2. **引用文档** - 明确告诉AI阅读哪些文档
3. **明确约束** - 清楚说明不要做什么
4. **要求确认** - 让AI说明理解了什么
5. **持续纠正** - AI偏离时及时提醒
6. **先检查现有** - 建议新文档/功能前先检查是否已有
7. **避免重复内容** - 明确文档职责，概览与详细分离

### 记忆口诀

```
文档先读，约束先行
轻量定位，牢记在心
引用章节，避免重复
确认理解，再动代码
检查现有，莫生新档
职责清晰，概详分离
```

---

**最后更新**：2026-01-15（新增陷阱3：文档内容重复）
**配合文档**：ARCHITECTURE.md、CONTRIBUTING.md
